USE WAREHOUSE COMETL_SFDC_XSMALL_WH;

USE SCHEMA COMETL_SFDC_STAGING;



create or replace TABLE ICUE_FMR_VEEVA_ALIGNMENT_TEMP (
	BATCH_ID FLOAT,
	OTA_ID VARCHAR(16777216),
	OBJECTID VARCHAR(16777216),
	OTA_ISDELETED NUMBER(38,0),
	TERR2_ID VARCHAR(16777216),
	TERR_NAME VARCHAR(16777216),
	USER_ID VARCHAR(16777216),
	USER_FIRSTNAME VARCHAR(16777216),
	USER_LASTNAME VARCHAR(16777216),
	USER_EMAIL__C VARCHAR(16777216),
	USER_PHONE__C VARCHAR(16777216),
	USER_USERNAME VARCHAR(16777216),
	USER_EXTERNAL_ID_PFI__C VARCHAR(16777216),
	USER_NETWORK_ID VARCHAR(16777216),
	MSP_ID VARCHAR(16777216),
	PRODUCT_VOD__C VARCHAR(16777216),
	MSP_EXTERNAL_ID VARCHAR(16777216),
	PRE_USER__C VARCHAR(16777216),
	FPRODUCTNAME_COE__C VARCHAR(16777216),
	PRE_FFRA_DETAIL_FLAG__C NUMBER(38,0),
	PRODUCT_NAME VARCHAR(16777216),
	PRODUCTID VARCHAR(16777216),
	PRODUCT_TYPE_VOD__C VARCHAR(16777216),
	PROD_EXTERNAL_ID_OM__C VARCHAR(16777216),
	PROD_ISDELETED NUMBER(38,0),
	MSP_ISDELETED NUMBER(38,0),
	UT2A_ISACTIVE NUMBER(38,0),
	USR_ISACTIVE NUMBER(38,0),
	COUNTRY_CODE VARCHAR(2),
	CREATED_DATE TIMESTAMP_NTZ(9),
	CREATED_BY VARCHAR(3),
	LAST_MODIFIED_DATE TIMESTAMP_NTZ(9),
	LAST_MODIFIED_BY VARCHAR(3)
);



create or replace TABLE ICUE_FMR_VEEVA_ALIGNMENT (
	BATCH_ID FLOAT,
	OTA_ID VARCHAR(16777216),
	OBJECTID VARCHAR(16777216),
	OTA_ISDELETED NUMBER(38,0),
	TERR2_ID VARCHAR(16777216),
	TERR_NAME VARCHAR(16777216),
	PFIZER_CUSTOMER_ID VARCHAR(16777216),
	ACCOUNT_ID VARCHAR(16777216),
	ACCOUNT_FIRSTNAME VARCHAR(16777216),
	ACCOUNT_LASTNAME VARCHAR(16777216),
	ACCOUNT_EMAIL1_PFI__C VARCHAR(16777216),
	ISPERSONACCOUNT NUMBER(38,0),
	USER_ID VARCHAR(16777216),
	USER_FIRSTNAME VARCHAR(16777216),
	USER_LASTNAME VARCHAR(16777216),
	USER_EMAIL__C VARCHAR(16777216),
	USER_PHONE__C VARCHAR(16777216),
	USER_USERNAME VARCHAR(16777216),
	USER_EXTERNAL_ID_PFI__C VARCHAR(16777216),
	USER_NETWORK_ID VARCHAR(16777216),
	MSP_ID VARCHAR(16777216),
	PRODUCT_VOD__C VARCHAR(16777216),
	MSP_EXTERNAL_ID VARCHAR(16777216),
	PRE_USER__C VARCHAR(16777216),
	FPRODUCTNAME_COE__C VARCHAR(16777216),
	PRE_FFRA_DETAIL_FLAG__C NUMBER(38,0),
	PRODUCTID VARCHAR(16777216),
	PRODUCT_NAME VARCHAR(16777216),
	PRODUCT_TYPE_VOD__C VARCHAR(16777216),
	PROD_EXTERNAL_ID_OM__C VARCHAR(16777216),
	OM_CUSTOMER_SK VARCHAR(200) COLLATE 'en-ci',
	OM_PRODUCT_SK VARCHAR(200) COLLATE 'en-ci',
	OM_EXCLUSION_FLAG VARCHAR(1),
	EFFECTIVE_DATE TIMESTAMP_NTZ(0),
	END_DATE TIMESTAMP_NTZ(0),
	OM_EXPLICIT_ALIGNMENT_PFI__C NUMBER(38,0),
	TSF_ISDELETED NUMBER(38,0),
	ACC_ISDELETED NUMBER(38,0),
	PROD_ISDELETED NUMBER(38,0),
	MSP_ISDELETED NUMBER(38,0),
	UT2A_ISACTIVE NUMBER(38,0),
	USR_ISACTIVE NUMBER(38,0),
	COUNTRY_CODE VARCHAR(2),
	CREATED_DATE TIMESTAMP_NTZ(9),
	CREATED_BY VARCHAR(3),
	LAST_MODIFIED_DATE TIMESTAMP_NTZ(9),
	LAST_MODIFIED_BY VARCHAR(3)
);




create or replace TABLE ICUE_FMR_OM_ALIGNMENT_TEMP (
	BATCH_ID FLOAT,
	CPA_OM_CUSTOMER_PRD_SALES_AREA_SK VARCHAR(18) COLLATE 'en-ci',
	CPA_OM_CUSTOMER_SK VARCHAR(200) COLLATE 'en-ci',
	CPA_OM_PRODUCT_SK VARCHAR(200) COLLATE 'en-ci',
	CPA_OM_SALES_AREA_SK VARCHAR(200) COLLATE 'en-ci',
	CPA_PFIZER_CUSTOMER_ID VARCHAR(200) COLLATE 'en-ci',
	CPA_CUSTOMER_TYPE_DESC VARCHAR(200) COLLATE 'en-ci',
	CPA_PRODUCT_CD VARCHAR(200) COLLATE 'en-ci',
	CPA_SALES_AREA_CD VARCHAR(200) COLLATE 'en-ci',
	CPA_SOURCE_CD VARCHAR(4) COLLATE 'en-ci',
	CPA_TYPE_CD VARCHAR(4) COLLATE 'en-ci',
	CPA_DATA_SOURCE_CD VARCHAR(4) COLLATE 'en-ci',
	EFFECTIVE_DATE TIMESTAMP_NTZ(0),
	END_DATE TIMESTAMP_NTZ(0),
	TERRITORY_ID VARCHAR(16777216),
	TERRITORY_NAME VARCHAR(16777216),
	USER_ID VARCHAR(16777216),
	USER_FIRSTNAME VARCHAR(16777216),
	USER_LASTNAME VARCHAR(16777216),
	USER_EMAIL__C VARCHAR(16777216),
	USER_PHONE__C VARCHAR(16777216),
	USER_USERNAME VARCHAR(16777216),
	USER_EXTERNAL_ID_PFI__C VARCHAR(16777216),
	USER_NETWORK_ID VARCHAR(16777216),
	USER_ISACTIVE NUMBER(38,0),
	UT2A_ISACTIVE NUMBER(38,0),
	TERR_IND_FLAG VARCHAR(1),
	USER_IND_FLAG VARCHAR(1),
	CREATED_DATE TIMESTAMP_NTZ(9),
	CREATED_BY VARCHAR(3),
	LAST_MODIFIED_DATE TIMESTAMP_NTZ(9),
	LAST_MODIFIED_BY VARCHAR(3)
);




create or replace TABLE ICUE_FMR_OM_ALIGNMENT (
	BATCH_ID FLOAT,
	CPA_OM_CUSTOMER_PRD_SALES_AREA_SK VARCHAR(18) COLLATE 'en-ci',
	CPA_OM_CUSTOMER_SK VARCHAR(200) COLLATE 'en-ci',
	CPA_OM_PRODUCT_SK VARCHAR(200) COLLATE 'en-ci',
	CPA_OM_SALES_AREA_SK VARCHAR(200) COLLATE 'en-ci',
	CPA_PFIZER_CUSTOMER_ID VARCHAR(200) COLLATE 'en-ci',
	CPA_CUSTOMER_TYPE_DESC VARCHAR(200) COLLATE 'en-ci',
	CPA_PRODUCT_CD VARCHAR(200) COLLATE 'en-ci',
	CPA_SALES_AREA_CD VARCHAR(200) COLLATE 'en-ci',
	CPA_SOURCE_CD VARCHAR(4) COLLATE 'en-ci',
	CPA_TYPE_CD VARCHAR(4) COLLATE 'en-ci',
	CPA_DATA_SOURCE_CD VARCHAR(4) COLLATE 'en-ci',
	CPA_EFFECTIVE_DATE TIMESTAMP_NTZ(0),
	CPA_END_DATE TIMESTAMP_NTZ(0),
	TERRITORY_VEEVA_ID VARCHAR(16777216),
	TERRITORY_NAME VARCHAR(16777216),
	USER_VEEVA_ID VARCHAR(16777216),
	USER_FIRSTNAME VARCHAR(16777216),
	USER_LASTNAME VARCHAR(16777216),
	USER_EMAIL__C VARCHAR(16777216),
	USER_PHONE__C VARCHAR(16777216),
	USER_USERNAME VARCHAR(16777216),
	USER_EXTERNAL_ID_PFI__C VARCHAR(16777216),
	USER_NETWORK_ID VARCHAR(16777216),
	USER_ISACTIVE NUMBER(38,0),
	UT2A_ISACTIVE NUMBER(38,0),
	TERR_IND_FLAG VARCHAR(1),
	USER_IND_FLAG VARCHAR(1),
	PRODUCT_NAME VARCHAR(16777216),
	PRODUCT_VEEVA_ID VARCHAR(16777216),
	PROD_EXTERNAL_ID_OM__C VARCHAR(16777216),
	PRODUCT_TYPE_VOD__C VARCHAR(16777216),
	PFIZER_CUSTOMER_PFI__C VARCHAR(16777216),
	ACCOUNT_VEEVA_ID VARCHAR(16777216),
	ACCOUNT_FIRSTNAME VARCHAR(16777216),
	ACCOUNT_LASTNAME VARCHAR(16777216),
	ACCOUNT_EMAIL1_PFI__C VARCHAR(16777216),
	PROD_ISDELETED NUMBER(38,0),
	ACC_ISDELETED NUMBER(38,0),
	ISPERSONACCOUNT NUMBER(38,0),
	CREATED_DATE TIMESTAMP_NTZ(9),
	CREATED_BY VARCHAR(3),
	LAST_MODIFIED_DATE TIMESTAMP_NTZ(9),
	LAST_MODIFIED_BY VARCHAR(3)
);




create or replace TABLE ICUE_FMR_OM_VEEVA_ALIGNMENT_360 (
	BATCH_ID NUMBER(4,0),
	UNIQUE_ROW_ID NUMBER(19,0),
	CPA_OM_CUSTOMER_PRD_SALES_AREA_SK VARCHAR(18) COLLATE 'en-ci',
	OTA_ID VARCHAR(16777216),
	CPA_SOURCE_CD VARCHAR(4) COLLATE 'en-ci',
	OM_TERRITORY_ID VARCHAR(16777216),
	OM_TERRITORY_NAME VARCHAR(16777216),
	OM_PRODUCT_NAME VARCHAR(16777216),
	OM_PRODUCTID VARCHAR(16777216),
	OM_PFIZER_CUSTOMER_ID VARCHAR(200) COLLATE 'en-ci',
	OM_ACCOUNT_ID VARCHAR(16777216),
	OM_ACCOUNT_FIRSTNAME VARCHAR(16777216),
	OM_ACCOUNT_LASTNAME VARCHAR(16777216),
	OM_ACCOUNT_EMAIL1_PFI__C VARCHAR(16777216),
	OM_USER_ID VARCHAR(16777216),
	OM_USER_FIRSTNAME VARCHAR(16777216),
	OM_USER_LASTNAME VARCHAR(16777216),
	OM_USER_EMAIL__C VARCHAR(16777216),
	OM_USER_PHONE__C VARCHAR(16777216),
	OM_USER_USERNAME VARCHAR(16777216),
	OM_USER_EXTERNAL_ID_PFI__C VARCHAR(16777216),
	OM_USER_NETWORK_ID VARCHAR(16777216),
	OM_EXPLICIT_ALIGNMENT_PFI__C NUMBER(38,0),
	VEEVA_TERRITORY_ID VARCHAR(16777216),
	VEEVA_NAME VARCHAR(16777216),
	VEEVA_USER_ID VARCHAR(16777216),
	VEEVA_PFIZER_CUSTOMER_ID VARCHAR(16777216),
	VEEVA_ACCOUNT_ID VARCHAR(16777216),
	VEEVA_ACCOUNT_FIRSTNAME VARCHAR(16777216),
	VEEVA_ACCOUNT_LASTNAME VARCHAR(16777216),
	VEEVA_ACCOUNT_EMAIL1_PFI__C VARCHAR(16777216),
	VEEVA_USER_FIRSTNAME VARCHAR(16777216),
	VEEVA_USER_LASTNAME VARCHAR(16777216),
	VEEVA_USER_EMAIL__C VARCHAR(16777216),
	VEEVA_USER_PHONE__C VARCHAR(16777216),
	VEEVA_USER_USERNAME VARCHAR(16777216),
	VEEVA_USER_EXTERNAL_ID_PFI__C VARCHAR(16777216),
	VEEVA_USER_NETWORK_ID VARCHAR(16777216),
	VEEVA_MSP_ID VARCHAR(16777216),
	VEEVA_PRODUCT_VOD__C VARCHAR(16777216),
	VEEVA_MSP_EXTERNAL_ID VARCHAR(16777216),
	VEEVA_PRE_USER__C VARCHAR(16777216),
	VEEVA_FPRODUCTNAME_COE__C VARCHAR(16777216),
	VEEVA_PRE_FFRA_DETAIL_FLAG__C NUMBER(38,0),
	VEEVA_PRODUCT_NAME VARCHAR(16777216),
	VEEVA_PRODUCTID VARCHAR(16777216),
	VEEVA_COUNTRY_CODE VARCHAR(2),
	OM_EXCLUSION_FLAG VARCHAR(1),
	OM_IND_FLAG VARCHAR(1),
	VEEVA_IND_FLAG VARCHAR(1),
	CREATED_DATE TIMESTAMP_NTZ(9),
	CREATED_BY VARCHAR(3),
	LAST_MODIFIED_DATE TIMESTAMP_NTZ(9),
	LAST_MODIFIED_BY VARCHAR(3)
);




create or replace TABLE ICUE_FMR_OM_VEEVA_ALIGNMENT (
	BATCH_ID NUMBER(4,0),
	UNIQUE_ROW_ID NUMBER(19,0),
	CPA_OM_CUSTOMER_PRD_SALES_AREA_SK VARCHAR(18) COLLATE 'en-ci',
	CPA_SOURCE_CD VARCHAR(4) COLLATE 'en-ci',
	OTA_ID VARCHAR(16777216),
	CPA_SOURCE_CODE VARCHAR(4) COLLATE 'en-ci',
	OM_EXPLICIT_ALIGNMENT_PFI__C NUMBER(38,0),
	TERRITORY_ID VARCHAR(16777216),
	TERRITORY_NAME VARCHAR(16777216),
	USER_ID VARCHAR(16777216),
	USER_NETWORK_ID VARCHAR(16777216),
	PFIZER_CUSTOMER_ID VARCHAR(16777216) COLLATE 'en-ci',
	USER_EXTERNAL_ID_PFI__C VARCHAR(16777216),
	USER_FIRSTNAME VARCHAR(16777216),
	USER_LASTNAME VARCHAR(16777216),
	USER_EMAIL__C VARCHAR(16777216),
	USER_PHONE__C VARCHAR(16777216),
	USER_USERNAME VARCHAR(16777216),
	PRODUCTID VARCHAR(16777216),
	PRODUCT_NAME VARCHAR(16777216),
	ACCOUNT_ID VARCHAR(16777216),
	ACCOUNT_FIRSTNAME VARCHAR(16777216),
	ACCOUNT_LASTNAME VARCHAR(16777216),
	ACCOUNT_EMAIL1_PFI__C VARCHAR(16777216),
	VEEVA_MSP_ID VARCHAR(16777216),
	VEEVA_PRODUCT_VOD__C VARCHAR(16777216),
	VEEVA_MSP_EXTERNAL_ID VARCHAR(16777216),
	VEEVA_PRE_USER__C VARCHAR(16777216),
	VEEVA_FPRODUCTNAME_COE__C VARCHAR(16777216),
	VEEVA_PRE_FFRA_DETAIL_FLAG__C NUMBER(38,0),
	OM_COUNTRY_CODE VARCHAR(2),
	OM_EXCLUSION_FLAG VARCHAR(1),
	OM_IND_FLAG VARCHAR(1),
	VEEVA_IND_FLAG VARCHAR(1),
	CREATED_DATE TIMESTAMP_NTZ(9),
	CREATED_BY VARCHAR(3),
	LAST_MODIFIED_DATE TIMESTAMP_NTZ(9),
	LAST_MODIFIED_BY VARCHAR(3)
);




create or replace TABLE ICUE_FMR_ALIGNMENT_FINAL (
	BATCH_ID FLOAT,
	UNIQUE_ROW_ID NUMBER(19,0),
	CPA_SOURCE_CODE VARCHAR(4) COLLATE 'en-ci',
	OM_EXPLICIT_ALIGNMENT_PFI__C NUMBER(38,0),
	TERRITORY_ID VARCHAR(16777216),
	TERRITORY_NAME VARCHAR(16777216),
	USER_ID VARCHAR(16777216),
	PFIZER_CUSTOMER_ID VARCHAR(16777216) COLLATE 'en-ci',
	ACCOUNT_ID VARCHAR(16777216),
	ACCOUNT_FIRSTNAME VARCHAR(16777216),
	ACCOUNT_LASTNAME VARCHAR(16777216),
	ACCOUNT_EMAIL1_PFI__C VARCHAR(16777216),
	USER_FIRSTNAME VARCHAR(16777216),
	USER_LASTNAME VARCHAR(16777216),
	USER_EMAIL__C VARCHAR(16777216),
	USER_PHONE__C VARCHAR(16777216),
	USER_USERNAME VARCHAR(16777216),
	USER_EXTERNAL_ID_PFI__C VARCHAR(16777216),
	USER_NETWORK_ID VARCHAR(16777216),
	VEEVA_MSP_ID VARCHAR(16777216),
	VEEVA_PRODUCT_VOD__C VARCHAR(16777216),
	VEEVA_MSP_EXTERNAL_ID VARCHAR(16777216),
	VEEVA_PRE_USER__C VARCHAR(16777216),
	VEEVA_FPRODUCTNAME_COE__C VARCHAR(16777216),
	VEEVA_PRE_FFRA_DETAIL_FLAG__C NUMBER(38,0),
	PRODUCT_NAME VARCHAR(16777216),
	PRODUCTID VARCHAR(16777216),
	COUNTRY_CODE VARCHAR(2),
	CREATED_DATE TIMESTAMP_NTZ(9),
	CREATED_BY VARCHAR(3)
);